### 13. 什么是虚拟 dom ？有什么用？

虚拟dom是真实dom的js对象

前提:

- 对真实dom的操作会引起页面的回流和重绘，而且页面的每一个部分都会重新渲染，很消耗浏览器的性能

作用:

1. 可以检测到发生改变的部分

2. 可以实现页面部分内容的重新渲染

3. 极大减少了浏览器性能的消耗

4. 同时支持服务器渲染

### 14. 虚拟 dom 的解析过程

1. **构建虚拟 DOM 树**：开发者编写的模板或组件代码会被编译器或解释器解析为虚拟 DOM 树。虚拟 DOM 树是一个纯 JavaScript 对象，描述了整个页面的结构和内容。

2. **初次渲染**：首次渲染时，将虚拟 DOM 树转化为真实 DOM 树并插入到页面中。这一过程也被称为“挂载”（mounting）。

3. **更新虚拟 DOM**：当页面需要更新时，开发者会使用 JavaScript 代码修改虚拟 DOM 树。在这个过程中，不会直接修改真实 DOM。

4. **比较虚拟 DOM**：比较修改前后的虚拟 DOM 树，找出需要更新的部分。

5. **更新真实 DOM**：根据比较结果，只更新需要更新的部分的真实 DOM。这个过程也被称为“重渲染”（re-rendering）。

### 15. diff 算法

**Diff算法是一种对比算法**。

对比两者是`旧虚拟DOM和新虚拟DOM`，对比出是哪个`虚拟节点`更改了，找出这个`虚拟节点`，并只更新这个虚拟节点所对应的`真实节点`，而不更新其他数据没发生改变的节点，实现`精准`地更新真实DOM，进而`提高效率`。

新旧虚拟DOM对比的时候，Diff算法比较只会在同层级进行, 不会跨层级比较。 所以Diff算法是:`深度优先算法`。 时间复杂度:`O(n)`

当数据改变时，会触发`setter`，并且通过`Dep.notify`去通知所有`订阅者Watcher`，订阅者们就会调用`patch方法`，给真实DOM打补丁，更新相应的视图。

对比的具体流程就是，判断节点是否相同，不相同就替换节点，相同则进一步判断子节点

**Vue 中 key 的作用**

1. 保证diff算法比较的新旧对象顺序不错乱，key值是唯一值，是一个可靠的识别属性

2. 优化性能，判断节点是否可以复用

### 16. 数据响应式原理

**vue2**

- 使用`Object.difineProperty`方法通过劫持数据结合发布者和订阅者模式来实现的

**vue3**

- 以`ref`函数生成的响应式数据对象与vue2的方式相同

- 以`reactive`函数生成的响应式数据对象使用`proxy`对数据进行代理，在这一种方式下，可以对对象的每一个属性进行监听，包括下标，目的是使对象、数组能够很好地实现数据响应

### 17. v-if 和 v-show 的区别

**v-show**

在条件为真时，对元素执行`display:none`，有一定的性能消耗

**v-if**

在条件为真时，直接将对应的元素节点消除，性能消耗大

不过在我自己认为，要实现元素的隐藏，我会根据需要从`opacity`,`visibility`,`display`,`v-if`中进行选择实现

### 18. v-if 和 v-for 哪个优先级更高

**在 Vue2 中，v-for 的优先级高，在 Vue3 中，v-if 优先级更高**。

所以在 Vue2 中，我们一般避免将 v-if 和 v-for 一起使用，因为一起使用时，每次 v-for 的循环都要进行一次 v-if 的条件判断，这无疑会对性能造成一些浪费。

为了避免这一情况，我们可以在外层嵌套 template（页面渲染不生成 DOM 节点），在这一层进行 v-if 判断，然后在内部进行 v-for 循环。

### 19. slot（插槽）的作用

slot 插槽是 Vue 的内容分发机制，它是组件内部的模板引擎承载分发内容的出口。slot 是子组件的模板标签元素，它的显示与否由父组件决定。slot 插槽又分为 3 类：具名插槽、匿名插槽和作用域插槽。

具名插槽：顾名思义是带有名字的插槽，它有 name 属性，一个组件可以有多个具名插槽。
匿名插槽：没有 name 属性，当组件没有指定 name 属性值的时候现实匿名插槽，一个组件只能有一个匿名插槽。
作用域插槽：它可以是具名的，也可以是匿名的，当子组件渲染该插槽时，可以讲子组件内部的数据传递给父组件，由父组件决定如何渲染该插槽。

### 20. computed（计算属性）和 watch（监听属性）的区别

**computed**

- 监听数据的计算结果
- 支持缓存(数据发生改变，会重新进行计算)
- 不支持异步
- 需要`return`

**watch**

- 监听数据的改变
- 不支持缓存
- 支持异步
- 用于在数据发生改变时，执行异步请求或动画效果

### 21. Vue 实现路由跳转的方法

使用 router-link 进行跳转

```js
<router-link to="/aaa/bbb">点击跳转到指定路由</router-link>
```

使用 this.$router.push 方法

```js
//以字符串形式进行跳转
this.$router.push('/aaa/bbb')
//以对象的形式进行跳转
this.$router.push({path:'/aaa/bbb'})

//对象的形式并且带参数，拼接在url后面或者放在 query 中
this.$router.push({path:'/aaa/bbb?name=123'})
this.$router.push({path: '/aaa/bbb', query: {name: "123"}})

//获取通过 query 带过来的参数对象
 console.log(this.$route.query)
```

使用 this.$router.replace 进行跳转

```js
//使用 replace 方法进行路由跳转时不会保存历史记录，点击返回也不会回到这个路由
this.$router.replace({path:'/aaa/bbb'});

//带参数方式同 push 方法
this.$router.replace({path:'/aaa/bbb', query: {name: "123"}});
```

使用 go 方法

```js
//跳转到上一页
this.$router.go(-1)
```

### 22. 路由的 hash 模式和 history 模式的区别

1. 在显示上，hash 路由会在 url 中添加 “#”，而 history 路由没有。
   

2. 底层的实现方式不同，hash 模式是通过 onhashChange 事件监听 location.hash 来实现的。而 history 模式是通过 pushState（或者 replaceState）和监听 popState 事件实现的。pushState 可以改变 url 地址实现跳转，而且页面不会刷新，它需要手动调用地址变化之后的处理函数，并在处理函数内部决定跳转逻辑。replaceState 可以读取浏览器的历史记录并修改。监听 popState 事件主要为了响应浏览器的前进和后退功能。
   

3. history 模式需要后端支持，比如：当用户输入 url 按回车，或者点击刷新浏览器时。因为在 history 模式下，前后端 url 必须保持一致，如果不一致的话则会返回 404 错误。

### 23. 说说 Vue 的优缺点

1. **轻量级框架**：只关注视图层，是一个构建数据的视图集合，大小只有几十 kb；

2. **简单易学**：国人开发，中文文档，不存在语言障碍 ，易于理解和学习；

3. **双向数据绑定**：保留了 angular 的特点，在数据操作方面更为简单；

4. **组件化**：保留了 react 的优点，实现了 html 的封装和重用，在构建单页面应用方面有着独特的优势；

5. **视图，数据，结构分离**：使数据的更改更为简单，不需要进行逻辑代码的修改，只需要操作数据就能完成相关操作；

6. **虚拟 DOM**：dom 操作是非常耗费性能的，不再使用原生的 dom 操作节点，极大解放 dom 操作，但具体操作的还是 dom 不过是换了另一种方式；

7. **运行速度更快**：相比较于 react 而言，同样是操作虚拟 dom，就性能而言， vue 存在很大的优势。

个人认为的优点,

1. 让编程者可以更加舒服地编程

2. 让浏览器可以更轻便地运行

3. 让数据有一个更优的执行规则

### 24. Vue 模板编译原理

在`Vue.js 2.0`中，模板编译是通过将模板转换为渲染函数来实现的。

渲染函数是一个函数，它返回虚拟DOM节点，用于渲染实际的DOM。

Vue.js的模板编译过程可以分为以下几个步骤：

- 词法分析和语法分析：使用正则表达式和AST语法树对模板进行解析和分析，生成一个抽象语法树（AST），以便后续的代码生成和优化。
- 代码生成：将抽象语法树转换为可执行的渲染函数，这个渲染函数是一个字符串形式的JavaScript代码，它将在运行时被执行。
- 优化：对渲染函数进行优化，包括静态节点的优化、事件处理函数的优化、渲染函数的缓存等。
- 编译入口函数：将模板字符串和编译选项传入编译入口函数中，调用相应的编译器函数进行编译，并将编译结果返回给调用者。

### 25. Vue 的性能优化

**一、编码阶段**

- 尽量减少 `data` 中的数据，`data` 中的数据都会增加 `getter` 和 `setter`，会收集对应的 `watcher`
- `v-if` 和 `v-for` 不能连用, v-for的优先级比v-if高，一起使用会造成性能浪费
- 如果需要使用 v-for 给每项元素绑定事件时使用事件代理
- SPA 页面采用 keep-alive 缓存组件
- 在更多的情况下，使用 v-if 替代 v-show
- key 保证唯一
- 使用路由懒加载、异步组件
- 防抖、节流
- 第三方模块按需导入
- 长列表滚动到可视区域动态加载
- 图片懒加载

**二、SEO 优化**

- 预渲染
- 服务端渲染 SSR

**三、打包优化**

- 压缩代码
- Tree Shaking/Scope Hoisting
- 使用 cdn 加载第三方模块
- 多线程打包 happypack
- splitChunks 抽离公共文件
- sourceMap 优化

**四、用户体验**

- 骨架屏
- PWA
- 还可以使用缓存(客户端缓存、服务端缓存)优化、服务端开启 gzip 压缩等。

**vue 中的 spa 应用如何优化首屏加载速度?**

**优化首屏加载可以从这几个方面开始：**

**请求优化**： `CDN` 将第三方的类库放到 `CDN` 上，能够大幅度减少生产环境中的项目体积，另外 `CDN` 能够实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上。

**缓存**：将长时间不会改变的第三方类库或者静态资源设置为强缓存，将 `max-age` 设置为一个非常长的时间，再将访问路径加上哈希达到哈希值变了以后保证获取到最新资源，好的缓存策略有助于减轻服务器的压力，并且显著的提升用户的体验

**gzip**：开启 `gzip` 压缩，通常开启 `gzip` 压缩能够有效的缩小传输资源的大小。

**http2**：如果系统首屏同一时间需要加载的静态资源非常多，但是浏览器对同域名的 `tcp` 连接数量是有限制的(`chrome` 为 6 个)超过规定数量的 `tcp` 连接，则必须要等到之前的请求收到响应后才能继续发送，而 `http2` 则可以在多个 `tcp` 连接中并发多个请求没有限制，在一些网络较差的环境开启 `http2` 性能提升尤为明显。

**懒加载**：当 `url` 匹配到相应的路径时，通过 `import` 动态加载页面组件，这样首屏的代码量会大幅减少，`webpack` 会把动态加载的页面组件分离成单独的一个 `chunk.js` 文件

**预渲染**：由于浏览器在渲染出页面之前，需要先加载和解析相应的 `html`、`css` 和 `js` 文件，为此会有一段白屏的时间，可以添加 `loading`，或者`骨架屏幕`尽可能的减少白屏对用户的影响体积优化

**合理使用第三方库**： 对于一些第三方 ui 框架、类库，尽量使用`按需加载`，减少打包体积

使用**可视化工具分析打包后的模块体积**：`webpack-bundle- analyzer` 这个插件在每次打包后能够更加直观的分析打包后模块的体积，再对其中比较大的模块进行优化

**提高代码使用率**： 利用`代码分割`，将脚本中无需立即调用的代码在代码构建时转变为异步加载的过程

**封装**：构建良好的项目架构，按照项目需求就行全局组件，插件，过滤器，指令，`utils` 等做一些公共封装，可以有效减少我们的代码量，而且更容易维护资源优化

**图片懒加载：** 使用图片懒加载可以优化同一时间减少 `http` 请求开销，避免显示图片导致的画面抖动，提高用户体验

**使用 svg 图标：** 相对于用一张图片来表示图标，`svg` 拥有更好的图片质量，体积更小，并且不需要开启额外的 `http` 请求

**压缩图片：** 可以使用 `image-webpack-loader`，在用户肉眼分辨不清的情况下一定程度上压缩图片



> 为什么想来到这里?
> 
> 我想了很久，之前一直都没有一个答案，最近，我大概可以回答这个问题了。
> 
> 我是一个贵州农村长大的孩子，家庭的破碎、好的教育资源稀缺，促使我18年的岁月都只能有悲伤和自卑相随，唯一的想法就是读着书，我也许会不痛苦，事实却是在人生道路上的形单影只，让我一直无法靠近我心里的成功。
> 
> 失败，失败，失败，萦绕在我当下的年岁，我不再敢去奢望，我不再相信，逃离的种子在眼泪中生根发芽。
> 
> 后面的日子里，我遇到一些人，我的爱人、亲人和很好的朋友，我多次向他们诉说，我就想这样过着，至少我不会再失败而痛苦，可是我实在无法对他们那份热切的期盼视而不见，我想着，我就鼓起勇气再试一试吧。
> 
> 我想来到这里，让自己变得自信一点，学习到有价值的东西，不荒废这人生黄金般的二十岁年纪，我很能吃苦的，我很希望能拥有这么一次机会，一次提升自己的机会，同时我也爱我的爱人，我想带给她一份幸福的生活，不然自己已经真的努力到快要走投无路了，感谢聆听。
> 
> ——2023.05.25    为什么想要来到这里
